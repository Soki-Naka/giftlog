<% provide(:title, @user.name) %>
<div class="border mb-5 bg-light w-75 mx-auto">
  <div class="text-center">
    <% if @user.image?%>
      <%= image_tag @user.image.to_s, size: '250x250', class: "rounded-circle"%>
    <% else %>
      <%= image_tag "default.jpg" %>
    <% end %>
    <h1><%= @user.name %></h1>
    <% if logged_in? %>
    <% @user ||= current_user %>
    <div>
      <a href="<%= following_user_path(@user) %>">
        <strong id="following">
          <%= @user.following.count %>
        </strong>
        フォロー
      </a>
      <a href="<%= followers_user_path(@user) %>">
        <strong id="followers">
          <%= @user.followers.count %>
        </strong>
        フォロワー
      </a>
    </div>
    <% else %>
    <div>
      <span>
        <strong id="following">
          <%= @user.following.count %>
        </strong>
        フォロー
      </span>
      <span>
        <strong id="followers">
          <%= @user.followers.count %>
        </strong>
        フォロワー
      </span>
    <% end %>
    </div>
    <div class="user-info col-3 mx-auto">
      <p>性別:<%= @user.gender %></p>
      <p>年齢:<%= @user.age %>歳</p>
      <p>職業:<%= @user.job %></p>
      <p>出身:<%= @user.prefecture %></p>
      <p>自己紹介:<%= @user.introduction %></p>
    </div>
  </div>
</div>

<div class="text-center">
  <% if logged_in? %>
    <% unless current_user?(@user) %>
      <div id="follow_form">
      <% if current_user.following?(@user) %>
        <%= render 'unfollow' %>
      <% else %>
        <%= render 'follow' %>
      <% end %>
      </div>
    <% end %>
  <% end %>
</div>

<% if false %>
<div class="container">
  <ul class="menu">
    <li><%= link_to "投稿一覧", @user %></li>
    <li><%= link_to "コメントした投稿", user_comments_path(@user.id) %></li>
    <li><%= link_to "いいね(投稿)", user_post_likes_path(@user.id) %></li>
    <li><%= link_to "いいね(コメント)", "#" %>
  </ul>
<div>
    <h1 class="text-center">投稿一覧</h1>
    <% if @user.posts.any? %>
      <%= render @posts%>
      <%= paginate @posts %>
    <% end %>
</div>
<% end %>

<ul class="nav nav-tabs justify-content-center w-75 mx-auto ">
  <li class="nav-item">
    <a href="#posts" class="nav-link active" data-toggle="tab">投稿一覧</a>
  </li>
  <li class="nav-item">
    <a href="#comments" class="nav-link" data-toggle="tab">コメントした投稿</a>
  </li>
  <li class="nav-item">
    <a href="#post-likes" class="nav-link" data-toggle="tab">いいねした投稿</a>
  </li>
</ul>

<div class="tab-content">
  <div id="posts" class="tab-pane active">
    <h1 class="text-center">投稿一覧</h1>
    <div class="w-75 mx-auto">
      <% if @user.posts.any? %>
        <%= render @posts %>
        <%= paginate @posts %>
      <% else %>
        <p class="text-center">投稿はありません。<br>投稿して、みんなに質問してみよう！</p>
      <% end %>
    </div>
  </div>

  <div id="comments" class="tab-pane">
    <h1 class="text-center">コメントした投稿</h1>
    <div class="w-75 mx-auto">
      <% if @user.comments.any? && @posts = @user.commented_posts.distinct.page(params[:page]).per(5) %>
        <%= render @posts %>
        <%= paginate @posts, theme: 'twitter-bootstrap-4' , pagination_class: "justify-content-center" %>
      <% else %>
        <p class="text-center">コメントした投稿はありません。<br>みんなの投稿にコメントしてみよう！</p>
      <% end %>
    </div>
  </div>

  <div id="post-likes" class="tab-pane">
    <h1 class="text-center">いいねした投稿</h1>
    <div class="w-75 mx-auto">
      <% if @user.post_likes.any? && @posts = @user.liked_posts.page(params[:page]).per(5) %>
      <%= render @posts %>
      <%= paginate @posts %>
      <% else %>
        <p class="text-center">いいねした投稿はありません。<br>みんなの投稿にいいねしてみよう！</p>
      <% end %>
    </div>
  </div>

</div>
